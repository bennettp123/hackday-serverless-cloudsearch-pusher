#!/usr/bin/env

import sys
import json

#original_doc = json.load(sys.stdin)

#with open('an-actual-message.json', 'r') as f:
#    original_doc = json.load(f)

#with open('event2.json', 'r') as f:
#    event = json.load(f)

event = {u'Records': [{u'body': u'{\n  "Type" : "Notification",\n  "MessageId" : "f06cc0d4-7693-59f5-95cb-94baaa7ddcea",\n  "TopicArn" : "arn:aws:sns:ap-southeast-2:949304525094:sns-dev-content",\n  "Message" : "{\\"correlationId\\":\\"cjoqngnga07ihii4mgyraj838\\",\\"message\\":{\\"type\\":\\"article\\",\\"version\\":1,\\"identifier\\":\\"1c7a9611c55449564af1669068702b96\\",\\"content\\":{\\"id\\":\\"1c7a9611c55449564af1669068702b96\\",\\"correlationIds\\":[{\\"kind\\":\\"methode\\",\\"value\\":\\"106877f4-ed3e-11e8-a63d-c6dbecca01db\\"}],\\"created\\":\\"\\",\\"publicationDate\\":\\"2018-11-21T04:07:00.000Z\\",\\"lastUpdated\\":\\"\\",\\"isSponsored\\":false,\\"kind\\":\\"article\\",\\"primaryTopic\\":\\"sport\\",\\"secondaryTopics\\":[\\"sport/cricket\\"],\\"source\\":\\"Herald Sun\\",\\"status\\":\\"premium\\",\\"assets\\":[{\\"kind\\":\\"image\\",\\"id\\":\\"bfbef718a43593b8d1bfd76a809f67ef\\",\\"name\\":\\"SUBSTITUTE_bfbef718a43593b8d1bfd76a809f67ef\\",\\"captionText\\":\\"\\",\\"byline\\":null,\\"credit\\":\\"News Corp Australia\\",\\"copyrightByline\\":\\"Philip Hillyard\\",\\"copyrightCredit\\":\\"METHODE\\",\\"crops\\":[],\\"original\\":{\\"format\\":\\"image/jpeg\\",\\"dimensions\\":\\"1024x768\\",\\"reference\\":\\"1542773421972_bfbef718a43593b8d1bfd76a809f67ef.jpeg\\"}},{\\"kind\\":\\"image\\",\\"id\\":\\"3944626b49ecb92f726b066e6154edba\\",\\"name\\":\\"SUBSTITUTE_3944626b49ecb92f726b066e6154edba\\",\\"captionText\\":\\"\\",\\"byline\\":null,\\"credit\\":\\"News Corp Australia\\",\\"copyrightByline\\":\\"Philip Hillyard\\",\\"copyrightCredit\\":\\"METHODE\\",\\"crops\\":[{\\"format\\":\\"image/jpeg\\",\\"dimensions\\":\\"149x86\\",\\"reference\\":\\"1542773421972_63e07da061144ff6086d3157b3acceb0.jpeg\\"},{\\"format\\":\\"image/jpeg\\",\\"dimensions\\":\\"1024x768\\",\\"reference\\":\\"1542773421972_bfbef718a43593b8d1bfd76a809f67ef.jpeg\\"},{\\"format\\":\\"image/jpeg\\",\\"dimensions\\":\\"1900x815\\",\\"reference\\":\\"1542773421972_e77ee575ca7b458b5fbe1720ea8a3383.jpeg\\"},{\\"format\\":\\"image/jpeg\\",\\"dimensions\\":\\"1280x720\\",\\"reference\\":\\"1542773421972_f093c339107338afa7b34673e15a698a.jpeg\\"}],\\"original\\":{\\"format\\":\\"image/jpeg\\",\\"dimensions\\":\\"768x1024\\",\\"reference\\":\\"1542773421972_3944626b49ecb92f726b066e6154edba.jpeg\\"}},{\\"kind\\":\\"image\\",\\"id\\":\\"f093c339107338afa7b34673e15a698a\\",\\"name\\":\\"SUBSTITUTE_f093c339107338afa7b34673e15a698a\\",\\"captionText\\":\\"\\",\\"byline\\":null,\\"credit\\":\\"News Corp Australia\\",\\"copyrightByline\\":\\"Philip Hillyard\\",\\"copyrightCredit\\":\\"METHODE\\",\\"crops\\":[],\\"original\\":{\\"format\\":\\"image/jpeg\\",\\"dimensions\\":\\"1280x720\\",\\"reference\\":\\"1542773421972_f093c339107338afa7b34673e15a698a.jpeg\\"}},{\\"kind\\":\\"image\\",\\"id\\":\\"e77ee575ca7b458b5fbe1720ea8a3383\\",\\"name\\":\\"SUBSTITUTE_e77ee575ca7b458b5fbe1720ea8a3383\\",\\"captionText\\":\\"\\",\\"byline\\":null,\\"credit\\":\\"News Corp Australia\\",\\"copyrightByline\\":\\"Philip Hillyard\\",\\"copyrightCredit\\":\\"METHODE\\",\\"crops\\":[],\\"original\\":{\\"format\\":\\"image/jpeg\\",\\"dimensions\\":\\"1900x815\\",\\"reference\\":\\"1542773421972_e77ee575ca7b458b5fbe1720ea8a3383.jpeg\\"}},{\\"kind\\":\\"image\\",\\"id\\":\\"63e07da061144ff6086d3157b3acceb0\\",\\"name\\":\\"SUBSTITUTE_63e07da061144ff6086d3157b3acceb0\\",\\"captionText\\":\\"\\",\\"byline\\":null,\\"credit\\":\\"News Corp Australia\\",\\"copyrightByline\\":\\"Philip Hillyard\\",\\"copyrightCredit\\":\\"METHODE\\",\\"crops\\":[],\\"original\\":{\\"format\\":\\"image/jpeg\\",\\"dimensions\\":\\"149x86\\",\\"reference\\":\\"1542773421972_63e07da061144ff6086d3157b3acceb0.jpeg\\"}},{\\"kind\\":\\"image\\",\\"id\\":\\"b10db39b33e8acb1342be549b0b9a07d\\",\\"name\\":\\"EMBEDDED_b10db39b33e8acb1342be549b0b9a07d\\",\\"captionText\\":\\"Ellyse Perry dancers with school children in Guyana.\\",\\"byline\\":null,\\"credit\\":\\"Supplied\\",\\"copyrightByline\\":null,\\"copyrightCredit\\":\\"METHODE\\",\\"crops\\":[],\\"original\\":{\\"format\\":\\"image/jpeg\\",\\"dimensions\\":\\"2047x1152\\",\\"reference\\":\\"1542773421972_b10db39b33e8acb1342be549b0b9a07d.jpeg\\"}},{\\"kind\\":\\"image\\",\\"id\\":\\"abf15ff8459e31105f79bf76dd7cd1d9\\",\\"name\\":\\"EMBEDDED_abf15ff8459e31105f79bf76dd7cd1d9\\",\\"captionText\\":\\"Ellyse Perry has showed how versatile she is at the WT20.\\",\\"byline\\":null,\\"credit\\":\\"Supplied\\",\\"copyrightByline\\":\\"Vincent Phoon\\",\\"copyrightCredit\\":\\"METHODE\\",\\"crops\\":[],\\"original\\":{\\"format\\":\\"image/jpeg\\",\\"dimensions\\":\\"2048x1152\\",\\"reference\\":\\"1542773421972_abf15ff8459e31105f79bf76dd7cd1d9.jpeg\\"}},{\\"kind\\":\\"image\\",\\"id\\":\\"2fd145fc748789620eb36d1862864247\\",\\"name\\":\\"EMBEDDED_2fd145fc748789620eb36d1862864247\\",\\"captionText\\":\\"Ellyse Perry poses with fans at North Sydney Oval. Picture: Chris Pavlich\\",\\"byline\\":null,\\"credit\\":\\"News Corp Australia\\",\\"copyrightByline\\":\\"Chris Pavlich Photography\\",\\"copyrightCredit\\":\\"METHODE\\",\\"crops\\":[],\\"original\\":{\\"format\\":\\"image/jpeg\\",\\"dimensions\\":\\"2048x2730\\",\\"reference\\":\\"1542773421972_2fd145fc748789620eb36d1862864247.jpeg\\"}},{\\"kind\\":\\"image\\",\\"id\\":\\"514d4c9e32951a7220467c4cac764b3d\\",\\"name\\":\\"EMBEDDED_514d4c9e32951a7220467c4cac764b3d\\",\\"captionText\\":\\"Ellyse Perry showing off her incredible action. Picture: AAP\\",\\"byline\\":null,\\"credit\\":\\"AAP\\",\\"copyrightByline\\":\\"DARREN ENGLAND\\",\\"copyrightCredit\\":\\"METHODE\\",\\"crops\\":[],\\"original\\":{\\"format\\":\\"image/jpeg\\",\\"dimensions\\":\\"1681x2241\\",\\"reference\\":\\"1542773421972_514d4c9e32951a7220467c4cac764b3d.jpeg\\"}},{\\"kind\\":\\"image\\",\\"id\\":\\"73746fcbc3c4f900a145f9f1bd806357\\",\\"name\\":\\"EMBEDDED_73746fcbc3c4f900a145f9f1bd806357\\",\\"captionText\\":\\"Ellyse Perry is married to Wallabies star Matt Toomua.\\",\\"byline\\":null,\\"credit\\":\\"Getty Images\\",\\"copyrightByline\\":\\"Robert Cianflone\\",\\"copyrightCredit\\":\\"METHODE\\",\\"crops\\":[],\\"original\\":{\\"format\\":\\"image/jpeg\\",\\"dimensions\\":\\"2048x1152\\",\\"reference\\":\\"1542773421972_73746fcbc3c4f900a145f9f1bd806357.jpeg\\"}},{\\"kind\\":\\"image\\",\\"id\\":\\"9a3d6b02cf84247f9b5e1fdd3256b790\\",\\"name\\":\\"EMBEDDED_9a3d6b02cf84247f9b5e1fdd3256b790\\",\\"captionText\\":\\"Perry in action for the Matildas.\\",\\"byline\\":null,\\"credit\\":\\"News Limited\\",\\"copyrightByline\\":null,\\"copyrightCredit\\":\\"METHODE\\",\\"crops\\":[],\\"original\\":{\\"format\\":\\"image/jpeg\\",\\"dimensions\\":\\"1324x745\\",\\"reference\\":\\"1542773421972_9a3d6b02cf84247f9b5e1fdd3256b790.jpeg\\"}}],\\"items\\":[{\\"kind\\":\\"byline\\",\\"text\\":\\"Eliza Sewell, Antigua\\",\\"name\\":null,\\"credit\\":null,\\"highlight\\":null,\\"dateline\\":null},{\\"kind\\":\\"content\\",\\"blocks\\":[{\\"kind\\":\\"unordered-list\\",\\"items\\":[{\\"kind\\":\\"text\\",\\"text\\":\\"Aussies won\u2019t dwell on history of Cup flops\\",\\"intentions\\":[{\\"kind\\":\\"link\\",\\"match\\":\\"Aussies won\u2019t dwell on history of Cup flops\\",\\"index\\":0,\\"href\\":\\"/sport/swoop/rachael-haynes-says-australia-wont-dwell-on-history-of-cup-flops/news-story/70949bd895ff7eef02d257d33131e1ff\\"},{\\"kind\\":\\"important\\",\\"match\\":\\"Aussies won\u2019t dwell on history of Cup flops\\",\\"index\\":0}]},{\\"kind\\":\\"text\\",\\"text\\":\\"Alyssa Healy set to pass concussion test\\",\\"intentions\\":[{\\"kind\\":\\"link\\",\\"match\\":\\"Alyssa Healy set to pass concussion test\\",\\"index\\":0,\\"href\\":\\"/sport/swoop/alyssa-healy-lightly-trained-ahead-of-world-t20-semifinal/news-story/fd659bf43490facd6f61d29215dd78a3\\"},{\\"kind\\":\\"important\\",\\"match\\":\\"Alyssa Healy set to pass concussion test\\",\\"index\\":0}]}]},{\\"kind\\":\\"text\\",\\"text\\":\\"A pre-swimming carnival pep talk taught star Australian allrounder Ellyse Perry about perspective.\\",\\"intentions\\":[]},{\\"kind\\":\\"text\\",\\"text\\":\\"From wunderkind to elder statesman in an 11-year international cricket career, Perry has evolved as a player and a person.\\",\\"intentions\\":[]},{\\"kind\\":\\"text\\",\\"text\\":\\"But the 28-year-old has never deviated from the message her mum Kathy taught her as a school kid.\\",\\"intentions\\":[]},{\\"kind\\":\\"text\\",\\"text\\":\\"\u201cI\u2019m sure I\u2019ve changed in that time in certain aspects but I\u2019d like to think essentially I\u2019m a similar person at heart, just older and wiser,\u201d Perry told News Corp Australia.\\",\\"intentions\\":[]},{\\"kind\\":\\"inline\\",\\"reference\\":\\"\\",\\"name\\":\\"EMBEDDED_b10db39b33e8acb1342be549b0b9a07d\\",\\"width\\":\\"\\",\\"height\\":\\"\\",\\"align\\":\\"center\\"},{\\"kind\\":\\"text\\",\\"text\\":\\"\u201cMy mum said this to me years ago when we were in the car going to a swimming carnival for school and I was so nervous - like crazy nervous, too nervous, a little bit beside myself and in a bit of a state - and she was just like \u2018You know what, no-one is going to remember tomorrow what you came in any race, it\u2019s really just about you going out there and giving it your best shot and enjoying it for what it is - whatever happens, happens.\\",\\"intentions\\":[]},{\\"kind\\":\\"text\\",\\"text\\":\\"\u201cIt\u2019s a little bit higher-stakes now, but I still feel like it\u2019s not a bad thing to think about.\u201d\\",\\"intentions\\":[]},{\\"kind\\":\\"text\\",\\"text\\":\\"Perry is enjoying every moment of the World T20 in the West Indies, but she desperately wants to bring the trophy home to Australia.\\",\\"intentions\\":[]},{\\"kind\\":\\"inline\\",\\"reference\\":\\"\\",\\"name\\":\\"EMBEDDED_abf15ff8459e31105f79bf76dd7cd1d9\\",\\"width\\":\\"\\",\\"height\\":\\"\\",\\"align\\":\\"center\\"},{\\"kind\\":\\"text\\",\\"text\\":\\"First the Australians must beat the West Indies in their semi-final on Friday morning.\\",\\"intentions\\":[]},{\\"kind\\":\\"text\\",\\"text\\":\\"\u201cWe really want to play well, obviously, because it\u2019s a World Cup,\u201d Perry said.\\",\\"intentions\\":[]},{\\"kind\\":\\"text\\",\\"text\\":\\"\u201cI think it would be affirmation in a lot of ways of what we\u2019re trying to do and a real sign that we\u2019re on the right track.\\",\\"intentions\\":[]},{\\"kind\\":\\"text\\",\\"text\\":\\"\u201cLooking further ahead to the T20 World Cup in 2020 in Australia, which is on the horizon, I just think being successful in this is a really great platform for us.\u201d\\",\\"intentions\\":[]},{\\"kind\\":\\"text\\",\\"text\\":\\"Now a married young woman, her husband Matt Toomua is in London with the Wallabies who play England at Twickenham on Sunday (AEDT) - the same day as the World T20 final.\\",\\"intentions\\":[]},{\\"kind\\":\\"text\\",\\"text\\":\\"Perry loves cricket as much as she did when she debuted for her country as a 16-year-old.\\",\\"intentions\\":[]},{\\"kind\\":\\"text\\",\\"text\\":\\"There were no contracts for female players then - now Australia\u2019s female cricketers are the best paid in the world.\\",\\"intentions\\":[]},{\\"kind\\":\\"inline\\",\\"reference\\":\\"\\",\\"name\\":\\"EMBEDDED_2fd145fc748789620eb36d1862864247\\",\\"width\\":\\"\\",\\"height\\":\\"\\",\\"align\\":\\"center\\"},{\\"kind\\":\\"inline\\",\\"reference\\":\\"\\",\\"name\\":\\"EMBEDDED_514d4c9e32951a7220467c4cac764b3d\\",\\"width\\":\\"\\",\\"height\\":\\"\\",\\"align\\":\\"center\\"},{\\"kind\\":\\"text\\",\\"text\\":\\"\u201cIt\u2019s been a really fun 11 years, included in that is the evolution of the sport, that\u2019s been one of the most amazing and satisfying things to be a part of,\u201d said Perry, the dual sport star who also has a soccer World Cup (2011) on her resume.\\",\\"intentions\\":[]},{\\"kind\\":\\"text\\",\\"text\\":\\"Perry used to be the person who opened the batting and the bowling, the classic best player in the team.\\",\\"intentions\\":[]},{\\"kind\\":\\"text\\",\\"text\\":\\"She\u2019s morphed into a new classic in modern sports \u2013 the role player. And a very good one.\\",\\"intentions\\":[]},{\\"kind\\":\\"text\\",\\"text\\":\\"Perry can be thrown anywhere and will do anything for her team.\\",\\"intentions\\":[]},{\\"kind\\":\\"text\\",\\"text\\":\\"Against India in the team\u2019s only loss in the Guyana pool games she came in at No.6 and made an unbeaten 39 off 28 balls. Earlier, she bowled her first ball in the eighth over and took 3-16.\\",\\"intentions\\":[]},{\\"kind\\":\\"inline\\",\\"reference\\":\\"\\",\\"name\\":\\"EMBEDDED_73746fcbc3c4f900a145f9f1bd806357\\",\\"width\\":\\"\\",\\"height\\":\\"\\",\\"align\\":\\"center\\"},{\\"kind\\":\\"text\\",\\"text\\":\\"\u201cI think it says that we\u2019ve got an incredibly talented group of players, all who are pushing each other to be better,\u201d she said.\\",\\"intentions\\":[]},{\\"kind\\":\\"text\\",\\"text\\":\\"\u201cThere\u2019s sort of no ego riding on that. You go around to any individual in this team and their No.1 goal is for the team to have success and not them and I think that makes a massive difference, particularly in competitions like this with there\u2019s a lot of pressure and expectation and you only get one chance.\u201d\\",\\"intentions\\":[]},{\\"kind\\":\\"text\\",\\"text\\":\\"Perry loves her family and she and Toomua want to start one of their own some day.\\",\\"intentions\\":[]},{\\"kind\\":\\"text\\",\\"text\\":\\"But that doesn\u2019t mean her sporting career would necessarily end.\\",\\"intentions\\":[]},{\\"kind\\":\\"text\\",\\"text\\":\\"\u201cI feel very, very fortunate to have him in my life,\u201d she said.\\",\\"intentions\\":[]},{\\"kind\\":\\"text\\",\\"text\\":\\"\u201cWe\u2019re both really lucky to be doing what we\u2019re doing at the moment.\\",\\"intentions\\":[]},{\\"kind\\":\\"inline\\",\\"reference\\":\\"\\",\\"name\\":\\"EMBEDDED_9a3d6b02cf84247f9b5e1fdd3256b790\\",\\"width\\":\\"\\",\\"height\\":\\"\\",\\"align\\":\\"center\\"},{\\"kind\\":\\"text\\",\\"text\\":\\"\u201c \u2026 Family is something that\u2019s really important to us and we\u2019d love to start at some point, it\u2019s just figuring out when that works for us.\\",\\"intentions\\":[]},{\\"kind\\":\\"text\\",\\"text\\":\\"\u201cI\u2019ve never thought about this before, but there\u2019s a lot of opportunities to come back and play for female athletes post starting a family, too.\\",\\"intentions\\":[]},{\\"kind\\":\\"text\\",\\"text\\":\\"\u201cWhether or not that\u2019s something I want to do, I don\u2019t really know. I guess I\u2019ll figure all that out when the time\u2019s right.\u201d\\",\\"intentions\\":[]},{\\"kind\\":\\"text\\",\\"text\\":\\"Every Test, ODI, T20I, and BBL match live. Get 1 month free Sport HD plus Entertainment with no lock-in contract and no iQ4 box fee. T&C apply. SIGN UP NOW!\\",\\"intentions\\":[{\\"kind\\":\\"link\\",\\"match\\":\\"SIGN UP NOW\\",\\"index\\":0,\\"href\\":\\"https://www.foxtel.com.au/shop/sports-offer.html?utm_source=herald-sun&utm_medium=link&utm_campaign=acquisition&utm_content=herald-sun-cricket-editorial-cricket-generic-variation-1\\"},{\\"kind\\":\\"important\\",\\"match\\":\\"Every Test, ODI, T20I, and BBL match live. Get 1 month free Sport HD plus Entertainment with no lock-in contract and no iQ4 box fee. T&C apply. SIGN UP NOW!\\",\\"index\\":0}]}]},{\\"kind\\":\\"head-kicker\\",\\"text\\":\\"Legend\\"},{\\"kind\\":\\"heading\\",\\"text\\":\\"Ellyse Perry credits simple message from mum for inspiring career\\"},{\\"kind\\":\\"homepage-head\\",\\"text\\":\\"Mum\u2019s message still inspiring golden girl Perry\\"},{\\"kind\\":\\"homepage-teaser\\",\\"text\\":\\"From wunderkind to elder statesman in an 11-year international cricket career, Ellyse Perry - and the Australian public - have mum Kathy to thank for maintaining one of the country\u2019s great sporting careers.\\"},{\\"kind\\":\\"canonical-url\\",\\"canonicalUrl\\":\\"http://www.heraldsun.com.au/sport/swoop/ellyse-perry-credits-simple-message-from-mum-for-inspiring-career/news-story/1c7a9611c55449564af1669068702b96\\"},{\\"kind\\":\\"canonical-title\\",\\"text\\":\\"Mum\u2019s message still inspiring golden girl Perry\\"},{\\"kind\\":\\"keywords\\",\\"keywords\\":[\\"international cricket career\\",\\"elder statesman\\",\\"golden girl\\",\\"pre-swimming carnival pep\\",\\"carnival pep talk\\",\\"role player\\",\\"married young woman\\",\\"school children\\",\\"pool games\\",\\"school kid\\",\\"bit higher-stakes\\",\\"trophy home\\",\\"box fee\\",\\"star Australian allrounder\\",\\"female cricketers\\",\\"female players\\",\\"female athletes\\",\\"real sign\\",\\"London\\",\\"United Kingdom\\",\\"Northern Europe\\",\\"Europe\\",\\"Guyana\\",\\"South America\\",\\"America\\",\\"Australia\\",\\"Australia and New Zealand\\",\\"Oceania\\",\\"India\\",\\"Southern Asia\\",\\"Asia\\",\\"Matt Toomua\\",\\"Ellyse Perry\\",\\"Chris Pavlich\\"]},{\\"kind\\":\\"main-image\\",\\"width\\":\\"\\",\\"height\\":\\"\\",\\"name\\":\\"SUBSTITUTE_3944626b49ecb92f726b066e6154edba\\"}],\\"parserType\\":\\"capi\\",\\"product\\":\\"PerthNow\\"},\\"original\\":{\\"type\\":\\"newsgate+capi+xml\\",\\"content\\":\\"\\",\\"product\\":\\"PerthNow\\"},\\"assets\\":[{\\"location\\":{\\"type\\":\\"s3\\",\\"bucketId\\":\\"s3-dev-thewest-batc-assetstore\\",\\"bucketPrefix\\":\\"\\",\\"path\\":\\"1c7a9611c55449564af1669068702b96/1542773421972_bfbef718a43593b8d1bfd76a809f67ef.jpeg\\"},\\"id\\":\\"bfbef718a43593b8d1bfd76a809f67ef\\",\\"kind\\":\\"image\\",\\"byline\\":null,\\"captionText\\":\\"\\",\\"copyright\\":{\\"byline\\":\\"Philip Hillyard\\",\\"credit\\":\\"METHODE\\"},\\"credit\\":\\"News Corp Australia\\",\\"filename\\":\\"1542773421972_bfbef718a43593b8d1bfd76a809f67ef.jpeg\\",\\"format\\":\\"image/jpeg\\",\\"name\\":\\"SUBSTITUTE_bfbef718a43593b8d1bfd76a809f67ef\\",\\"crops\\":[]},{\\"location\\":{\\"type\\":\\"s3\\",\\"bucketId\\":\\"s3-dev-thewest-batc-assetstore\\",\\"bucketPrefix\\":\\"\\",\\"path\\":\\"1c7a9611c55449564af1669068702b96/1542773421972_3944626b49ecb92f726b066e6154edba.jpeg\\"},\\"id\\":\\"3944626b49ecb92f726b066e6154edba\\",\\"kind\\":\\"image\\",\\"byline\\":null,\\"captionText\\":\\"\\",\\"copyright\\":{\\"byline\\":\\"Philip Hillyard\\",\\"credit\\":\\"METHODE\\"},\\"credit\\":\\"News Corp Australia\\",\\"filename\\":\\"1542773421972_3944626b49ecb92f726b066e6154edba.jpeg\\",\\"format\\":\\"image/jpeg\\",\\"name\\":\\"SUBSTITUTE_3944626b49ecb92f726b066e6154edba\\",\\"crops\\":[{\\"format\\":\\"image/jpeg\\",\\"filename\\":\\"1542773421972_63e07da061144ff6086d3157b3acceb0.jpeg\\",\\"dimensions\\":\\"149x86\\"},{\\"format\\":\\"image/jpeg\\",\\"filename\\":\\"1542773421972_bfbef718a43593b8d1bfd76a809f67ef.jpeg\\",\\"dimensions\\":\\"1024x768\\"},{\\"format\\":\\"image/jpeg\\",\\"filename\\":\\"1542773421972_e77ee575ca7b458b5fbe1720ea8a3383.jpeg\\",\\"dimensions\\":\\"1900x815\\"},{\\"format\\":\\"image/jpeg\\",\\"filename\\":\\"1542773421972_f093c339107338afa7b34673e15a698a.jpeg\\",\\"dimensions\\":\\"1280x720\\"}]},{\\"location\\":{\\"type\\":\\"s3\\",\\"bucketId\\":\\"s3-dev-thewest-batc-assetstore\\",\\"bucketPrefix\\":\\"\\",\\"path\\":\\"1c7a9611c55449564af1669068702b96/1542773421972_f093c339107338afa7b34673e15a698a.jpeg\\"},\\"id\\":\\"f093c339107338afa7b34673e15a698a\\",\\"kind\\":\\"image\\",\\"byline\\":null,\\"captionText\\":\\"\\",\\"copyright\\":{\\"byline\\":\\"Philip Hillyard\\",\\"credit\\":\\"METHODE\\"},\\"credit\\":\\"News Corp Australia\\",\\"filename\\":\\"1542773421972_f093c339107338afa7b34673e15a698a.jpeg\\",\\"format\\":\\"image/jpeg\\",\\"name\\":\\"SUBSTITUTE_f093c339107338afa7b34673e15a698a\\",\\"crops\\":[]},{\\"location\\":{\\"type\\":\\"s3\\",\\"bucketId\\":\\"s3-dev-thewest-batc-assetstore\\",\\"bucketPrefix\\":\\"\\",\\"path\\":\\"1c7a9611c55449564af1669068702b96/1542773421972_e77ee575ca7b458b5fbe1720ea8a3383.jpeg\\"},\\"id\\":\\"e77ee575ca7b458b5fbe1720ea8a3383\\",\\"kind\\":\\"image\\",\\"byline\\":null,\\"captionText\\":\\"\\",\\"copyright\\":{\\"byline\\":\\"Philip Hillyard\\",\\"credit\\":\\"METHODE\\"},\\"credit\\":\\"News Corp Australia\\",\\"filename\\":\\"1542773421972_e77ee575ca7b458b5fbe1720ea8a3383.jpeg\\",\\"format\\":\\"image/jpeg\\",\\"name\\":\\"SUBSTITUTE_e77ee575ca7b458b5fbe1720ea8a3383\\",\\"crops\\":[]},{\\"location\\":{\\"type\\":\\"s3\\",\\"bucketId\\":\\"s3-dev-thewest-batc-assetstore\\",\\"bucketPrefix\\":\\"\\",\\"path\\":\\"1c7a9611c55449564af1669068702b96/1542773421972_63e07da061144ff6086d3157b3acceb0.jpeg\\"},\\"id\\":\\"63e07da061144ff6086d3157b3acceb0\\",\\"kind\\":\\"image\\",\\"byline\\":null,\\"captionText\\":\\"\\",\\"copyright\\":{\\"byline\\":\\"Philip Hillyard\\",\\"credit\\":\\"METHODE\\"},\\"credit\\":\\"News Corp Australia\\",\\"filename\\":\\"1542773421972_63e07da061144ff6086d3157b3acceb0.jpeg\\",\\"format\\":\\"image/jpeg\\",\\"name\\":\\"SUBSTITUTE_63e07da061144ff6086d3157b3acceb0\\",\\"crops\\":[]},{\\"location\\":{\\"type\\":\\"s3\\",\\"bucketId\\":\\"s3-dev-thewest-batc-assetstore\\",\\"bucketPrefix\\":\\"\\",\\"path\\":\\"1c7a9611c55449564af1669068702b96/1542773421972_b10db39b33e8acb1342be549b0b9a07d.jpeg\\"},\\"id\\":\\"b10db39b33e8acb1342be549b0b9a07d\\",\\"kind\\":\\"image\\",\\"byline\\":null,\\"captionText\\":\\"Ellyse Perry dancers with school children in Guyana.\\",\\"copyright\\":{\\"byline\\":null,\\"credit\\":\\"METHODE\\"},\\"credit\\":\\"Supplied\\",\\"filename\\":\\"1542773421972_b10db39b33e8acb1342be549b0b9a07d.jpeg\\",\\"format\\":\\"image/jpeg\\",\\"name\\":\\"EMBEDDED_b10db39b33e8acb1342be549b0b9a07d\\",\\"crops\\":[]},{\\"location\\":{\\"type\\":\\"s3\\",\\"bucketId\\":\\"s3-dev-thewest-batc-assetstore\\",\\"bucketPrefix\\":\\"\\",\\"path\\":\\"1c7a9611c55449564af1669068702b96/1542773421972_abf15ff8459e31105f79bf76dd7cd1d9.jpeg\\"},\\"id\\":\\"abf15ff8459e31105f79bf76dd7cd1d9\\",\\"kind\\":\\"image\\",\\"byline\\":null,\\"captionText\\":\\"Ellyse Perry has showed how versatile she is at the WT20.\\",\\"copyright\\":{\\"byline\\":\\"Vincent Phoon\\",\\"credit\\":\\"METHODE\\"},\\"credit\\":\\"Supplied\\",\\"filename\\":\\"1542773421972_abf15ff8459e31105f79bf76dd7cd1d9.jpeg\\",\\"format\\":\\"image/jpeg\\",\\"name\\":\\"EMBEDDED_abf15ff8459e31105f79bf76dd7cd1d9\\",\\"crops\\":[]},{\\"location\\":{\\"type\\":\\"s3\\",\\"bucketId\\":\\"s3-dev-thewest-batc-assetstore\\",\\"bucketPrefix\\":\\"\\",\\"path\\":\\"1c7a9611c55449564af1669068702b96/1542773421972_2fd145fc748789620eb36d1862864247.jpeg\\"},\\"id\\":\\"2fd145fc748789620eb36d1862864247\\",\\"kind\\":\\"image\\",\\"byline\\":null,\\"captionText\\":\\"Ellyse Perry poses with fans at North Sydney Oval. Picture: Chris Pavlich\\",\\"copyright\\":{\\"byline\\":\\"Chris Pavlich Photography\\",\\"credit\\":\\"METHODE\\"},\\"credit\\":\\"News Corp Australia\\",\\"filename\\":\\"1542773421972_2fd145fc748789620eb36d1862864247.jpeg\\",\\"format\\":\\"image/jpeg\\",\\"name\\":\\"EMBEDDED_2fd145fc748789620eb36d1862864247\\",\\"crops\\":[]},{\\"location\\":{\\"type\\":\\"s3\\",\\"bucketId\\":\\"s3-dev-thewest-batc-assetstore\\",\\"bucketPrefix\\":\\"\\",\\"path\\":\\"1c7a9611c55449564af1669068702b96/1542773421972_514d4c9e32951a7220467c4cac764b3d.jpeg\\"},\\"id\\":\\"514d4c9e32951a7220467c4cac764b3d\\",\\"kind\\":\\"image\\",\\"byline\\":null,\\"captionText\\":\\"Ellyse Perry showing off her incredible action. Picture: AAP\\",\\"copyright\\":{\\"byline\\":\\"DARREN ENGLAND\\",\\"credit\\":\\"METHODE\\"},\\"credit\\":\\"AAP\\",\\"filename\\":\\"1542773421972_514d4c9e32951a7220467c4cac764b3d.jpeg\\",\\"format\\":\\"image/jpeg\\",\\"name\\":\\"EMBEDDED_514d4c9e32951a7220467c4cac764b3d\\",\\"crops\\":[]},{\\"location\\":{\\"type\\":\\"s3\\",\\"bucketId\\":\\"s3-dev-thewest-batc-assetstore\\",\\"bucketPrefix\\":\\"\\",\\"path\\":\\"1c7a9611c55449564af1669068702b96/1542773421972_73746fcbc3c4f900a145f9f1bd806357.jpeg\\"},\\"id\\":\\"73746fcbc3c4f900a145f9f1bd806357\\",\\"kind\\":\\"image\\",\\"byline\\":null,\\"captionText\\":\\"Ellyse Perry is married to Wallabies star Matt Toomua.\\",\\"copyright\\":{\\"byline\\":\\"Robert Cianflone\\",\\"credit\\":\\"METHODE\\"},\\"credit\\":\\"Getty Images\\",\\"filename\\":\\"1542773421972_73746fcbc3c4f900a145f9f1bd806357.jpeg\\",\\"format\\":\\"image/jpeg\\",\\"name\\":\\"EMBEDDED_73746fcbc3c4f900a145f9f1bd806357\\",\\"crops\\":[]},{\\"location\\":{\\"type\\":\\"s3\\",\\"bucketId\\":\\"s3-dev-thewest-batc-assetstore\\",\\"bucketPrefix\\":\\"\\",\\"path\\":\\"1c7a9611c55449564af1669068702b96/1542773421972_9a3d6b02cf84247f9b5e1fdd3256b790.jpeg\\"},\\"id\\":\\"9a3d6b02cf84247f9b5e1fdd3256b790\\",\\"kind\\":\\"image\\",\\"byline\\":null,\\"captionText\\":\\"Perry in action for the Matildas.\\",\\"copyright\\":{\\"byline\\":null,\\"credit\\":\\"METHODE\\"},\\"credit\\":\\"News Limited\\",\\"filename\\":\\"1542773421972_9a3d6b02cf84247f9b5e1fdd3256b790.jpeg\\",\\"format\\":\\"image/jpeg\\",\\"name\\":\\"EMBEDDED_9a3d6b02cf84247f9b5e1fdd3256b790\\",\\"crops\\":[]}]}}",\n  "Timestamp" : "2018-11-21T04:10:22.579Z",\n  "SignatureVersion" : "1",\n  "Signature" : "gS63iItaNLD3Fx7IsD46qzyyoPqMnGc5kVkm+XiecQ4i+1AKUVJbpa/u+O8lIE0l/OIGvIThVvYXCmorzUmp01VDELaQILm765c0cHq2J0kC06Ejl452QtAYi6X+QjqbMbs736SKo3nuLzOR8/BSAtCm5z8bvKY/UNToIKTO6r3R16XvpkQaCELpTSUitU7Xqib5hisGWD9wKgLl3TlqMD86jCPzRFqsxFedRO41iimV51Ur8uUtxVEHc8XN+p0OX0S3M14/oYBJvOlHwuJrHLqWRjBVyvapDJnm/ZsmXyZZez1QBgY8yWsE20qBjjSVSJGi78fyhOgmSucq6fLYeQ==",\n  "SigningCertURL" : "https://sns.ap-southeast-2.amazonaws.com/SimpleNotificationService-ac565b8b1a6c5d002d285f9598aa1d9b.pem",\n  "UnsubscribeURL" : "https://sns.ap-southeast-2.amazonaws.com/?Action=Unsubscribe&SubscriptionArn=arn:aws:sns:ap-southeast-2:949304525094:sns-dev-content:c470ff4e-69c5-4183-b568-0e543c3a4a35"\n}', u'receiptHandle': u'AQEBmJc8fMVCqSFWH+rLSxChWv8Tp3NAdvM8sbYbFGrj6nVLcRdJYKfG/5pK4Re4uekwZeYQlfT8QvgNMBqbdn5MioMIE8OHB10WjdI2GDxbRUCwtPRZ551sa+9kQh8sFlFehnZGOW/8s7AthH9d82k1qvkdVkMSBQ+tJTkkwLdwPh3CSktjTeS/heI0dVr8RT4Jeu1SrDPi8BffS8Q1+dF/QVIT3U7cwSv2T8sLugJWxcxXdZCuI511Z7iQZdA1vxpd/r7+QpNQgMNZZoT+Muu5lDIR7xwi4Bj+rWUSs5CnSizXlwqtONwuNQNHVQAackI/gs9OWowuxBiRgiNDkvIHEr0SwKObiKzq8wxHVO5Mb5ULiliaw51lxk0IzG/enj3B11TLZb+41x83Z+qN96sm/A==', u'md5OfBody': u'8af57fcdf979a52697d288ca8df18927', u'eventSourceARN': u'arn:aws:sqs:ap-southeast-2:949304525094:bennetts-test-queue', u'eventSource': u'aws:sqs', u'awsRegion': u'ap-southeast-2', u'messageId': u'84c44a52-b6a8-498e-a46c-e70f4b5d69bd', u'attributes': {u'ApproximateFirstReceiveTimestamp': u'1542773422663', u'SenderId': u'AIDAIY4XCTD3OFZN5ED42', u'ApproximateReceiveCount': u'1', u'SentTimestamp': u'1542773422661'}, u'messageAttributes': {}}]}

import pdb; pdb.set_trace()

content = original_doc['message']['content']
ident = original_doc['message']['identifier']
status = content['status']
kind = content['kind']
assets = content['assets']
topics = list(set(content['secondaryTopics'] + [content['primaryTopic']]))
product = content['product']
source = content['source']
items = content['items']

heading = [x for x in items if x['kind'] == 'heading']
head_kicker = [x for x in items if x['kind'] == 'head-kicker']
homepage_head = [x for x in items if x['kind'] == 'homepage-head']
homepage_teaser = [x for x in items if x['kind'] == 'homepage-teaser']
canonical_url = [x for x in items if x['kind'] == 'canonical-url']
canonical_title = [x for x in items if x['kind'] == 'canonical-title']
keywords = [x for x in items if x['kind'] == 'keywords']
main_image = [x for x in items if x['kind'] == 'main-image']
actual_content = [x for x in items if x['kind'] == 'content']

#import pdb; pdb.set_trace()

flatten = lambda l: [item for sublist in l for item in sublist]

search_doc = {
    "type": "add",
    "id": ident,
    "fields": {
        "heading": ' '.join(x['text'] for x in heading),
        "head_kicker": ' '.join(x['text'] for x in head_kicker),
        "homepage_head": ' '.join(x['text'] for x in homepage_head),
        "homepage_teaser": ' '.join(x['text'] for x in homepage_teaser),
        "canonical_url": [x['canonicalUrl'] for x in canonical_url],
        "canonical_title": ' '.join(x['text'] for x in canonical_title),
        "keywords": flatten([x['keywords'] for x in keywords]),
        "main_image": [x['name'] for x in main_image],
        "content": ' '.join([y['text'] for y in flatten([x['blocks'] for x in actual_content])]),
        "status": status,
        "kind": kind,
        "topics": topics,
        "product": product,
        "source": source,
    },
}

#import pdb; pdb.set_trace()
#print('cool.')

#print(json.dumps(search_doc['fields']))
print(json.dumps([search_doc]))

